<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - Cutiefic</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html">Cutiefic</a>
                </div>
                <a href="cart.html" class="cart-icon active">
                    ğŸ›’
                    <span class="cart-count" id="cartCount">0</span>
                </a>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html">Home</a> / <span>Shopping Cart</span>
            </div>

            <section class="cart-section">
                <h2>Your Shopping Cart ğŸ›ï¸</h2>
                
                <div id="cartItems" class="cart-items"></div>
                
                <div id="emptyCart" class="empty-cart" style="display: none;">
                    <p>Your cart is empty! ğŸ˜¢</p>
                    <a href="index.html" class="btn-primary">Start Shopping</a>
                </div>

                <div id="cartSummary" class="cart-summary" style="display: none;">
                    <div class="summary-row">
                        <span class="summary-label">Subtotal:</span>
                        <span class="summary-value" id="subtotal">â‚¹0</span>
                    </div>
                    <div class="summary-row total">
                        <span class="summary-label">Grand Total:</span>
                        <span class="summary-value" id="grandTotal">â‚¹0</span>
                    </div>
                    <button onclick="proceedToCheckout()" class="checkout-btn">
                        Proceed to Checkout ğŸ’³
                    </button>
                </div>
            </section>
        </div>
    </main>

    <div id="checkoutModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCheckoutModal()">&times;</span>
            <h2>Checkout Details</h2>
            <form id="checkoutForm">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" id="customerName" required>
                </div>
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" id="customerPhone" required>
                </div>
                <div class="form-group">
                    <label>Delivery Address *</label>
                    <textarea id="customerAddress" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Transport Name (Optional)</label>
                    <input type="text" id="transportName">
                </div>
                <button type="submit" class="submit-btn">
                    Send Order via WhatsApp ğŸ’¬
                </button>
            </form>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>ğŸ’• Made with love by Cutiefic ğŸ’•</p>
        </div>
    </footer>

    <script src="js/cart.js"></script>
    <script>
        function renderCart() {
            const cart = getCart();
            const cartItemsDiv = document.getElementById('cartItems');
            const emptyCartDiv = document.getElementById('emptyCart');
            const summaryDiv = document.getElementById('cartSummary');
            
            if (cart.length === 0) {
                cartItemsDiv.innerHTML = '';
                emptyCartDiv.style.display = 'block';
                summaryDiv.style.display = 'none';
                return;
            }
            
            emptyCartDiv.style.display = 'none';
            summaryDiv.style.display = 'block';
            
            cartItemsDiv.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <div class="cart-item-image">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    <div class="cart-item-details">
                        <h3>${item.name}</h3>
                        <p class="cart-item-sku">SKU: ${item.sku}</p>
                    </div>
                    <div class="cart-item-actions">
                        <div class="quantity-selector">
                            <button onclick="updateCartQuantity('${item.id}', ${item.quantity - 1})" class="qty-btn">âˆ’</button>
                            <input type="number" value="${item.quantity}" min="1" readonly>
                            <button onclick="updateCartQuantity('${item.id}', ${item.quantity + 1})" class="qty-btn">+</button>
                        </div>
                        <button onclick="removeFromCartAndUpdate('${item.id}')" class="remove-btn">
                            Remove ğŸ—‘ï¸
                        </button>
                    </div>
                </div>
            `).join('');
            
            updateSummary();
        }

        function updateSummary() {
            const cart = getCart();
            const total = cart.reduce((sum, item) => sum + (item.quantity), 0);
            
            document.getElementById('subtotal').textContent = `â‚¹${total}`;
            document.getElementById('grandTotal').textContent = `â‚¹${total}`;
        }

        function updateCartQuantity(productId, newQty) {
            if (newQty < 1) {
                if (confirm('Remove this item from cart?')) {
                    removeFromCart(productId);
                    renderCart();
                    updateCartCount();
                }
            } else {
                const cart = getCart();
                const item = cart.find(i => i.id === productId);
                if (item) {
                    item.quantity = newQty;
                    saveCart(cart);
                    renderCart();
                    updateCartCount();
                }
            }
        }

        function removeFromCartAndUpdate(productId) {
            if (confirm('Remove this item from cart?')) {
                removeFromCart(productId);
                renderCart();
                updateCartCount();
            }
        }

        function proceedToCheckout() {
            document.getElementById('checkoutModal').style.display = 'block';
        }

        function closeCheckoutModal() {
            document.getElementById('checkoutModal').style.display = 'none';
        }

        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const cart = getCart();
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const address = document.getElementById('customerAddress').value;
            const transport = document.getElementById('transportName').value;
            
            let message = `ğŸ€ *New Order from Cutiefic* ğŸ€\n\n`;
            message += `ğŸ“¦ *Order Details:*\n`;
            message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
            
            cart.forEach((item, index) => {
                message += `${index + 1}. ${item.name}\n`;
                message += `   SKU: ${item.sku}\n`;
                message += `   Quantity: ${item.quantity}\n`;
                message += `   ${item.quantity} = â‚¹${item.quantity}\n\n`;
            });
            
            const total = cart.reduce((sum, item) => sum + (item.quantity), 0);
            message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
            message += `ğŸ’° *Grand Total: â‚¹${total}*\n\n`;
            message += `ğŸ‘¤ *Customer Details:*\n`;
            message += `Name: ${name}\n`;
            message += `Phone: ${phone}\n`;
            message += `Address: ${address}\n`;
            if (transport) {
                message += `Transport: ${transport}\n`;
            }
            
            const whatsappUrl = `https://wa.me/919020902902?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
            
            closeCheckoutModal();
        });

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('checkoutModal');
            if (event.target == modal) {
                closeCheckoutModal();
            }
        }

        // Initialize
        renderCart();
        updateCartCount();
    </script>
</body>
</html>